# VOICEVOX 音声読み上げツール

本アプリケーションは、VOICEVOXの全話者に対応したゲーム内ボイスチャット用音声読み上げデスクトップアプリケーションです。テキストを入力することで、リアルタイムに音声を生成し、仮想オーディオデバイスを経由してゲームやDiscord等のボイスチャットに送信することができます。

**⚡ VOICEVOX Engine 同梱**: アプリケーションにVOICEVOX Engineが同梱されており、別途インストールや起動の必要はありません。ダウンロードしてすぐに使い始められます。

## 主な機能

### 高速・低遅延処理

- Socket.IOとWeb Audio APIによる高速音声生成および再生
- ファイル監視を使用せず、即座に音声を生成・再生
- 約350-900msの処理時間を実現（従来手法の数秒から大幅に改善）

### ユーザーインターフェース

- React + TailwindCSSによる直感的なインターフェース
- ダークテーマによる視認性の向上
- 詳細な設定画面による柔軟なカスタマイズ

### 設定機能

- **音声パラメータ調整**: 速度、ピッチ、抑揚、音量を詳細に設定可能
- **キーバインドカスタマイズ**: 全操作にショートカットキーを割り当て可能
- **グローバルホットキー**: アプリケーションがバックグラウンドでも動作
- **テキスト自動置換**: 頻繁に使用する変換ルールの登録
- **設定のバックアップ**: 設定のエクスポートおよびインポートに対応

### 便利な機能

- 読み上げ履歴機能による過去のテキストの再利用
- クリップボードから直接読み上げ
- 処理時間の表示によるパフォーマンスモニタリング
- VOICEVOX全話者対応（ずんだもん、四国めたん、春日部つむぎ等）

### デスクトップアプリケーション

- Electron製のWindows専用アプリケーション
- 実行可能ファイル（exe、ポータブル版）形式で配布可能
- システムトレイへの最小化機能
- 単一インスタンス実行による競合回避

## システム要件

### 必要なソフトウェア

- **仮想オーディオデバイス**: VB-CABLE
  - VB-CABLE ダウンロード: https://vb-audio.com/Cable/
  - アプリに同梱されているため、別途ダウンロード不要

**注意**: VOICEVOX Engine はアプリケーションに同梱されているため、別途ダウンロード・インストールは不要です。

### 開発環境

- **Node.js**: バージョン18以上

### 対応オペレーティングシステム

- **Windows 10 / 11 専用**

## 使用方法

### 配布版の使用

1. **仮想オーディオデバイスの設定**
   - アプリに同梱されているVB-CABLEをインストールします（セットアップウィザードから可能）
   - Windowsの「サウンド設定」から「出力デバイス」を「CABLE Input」に設定します
   - Discord/ゲームの「マイク入力」を「CABLE Output」に設定します

2. **アプリケーションの起動**
   - 実行可能ファイルを起動します
   - VOICEVOX Engine が自動的に起動します（初回は数秒かかります）
   - ステータスバーでVOICEVOX接続状態を確認してください

3. **音声読み上げ**
   - テキストエリアに読み上げたい文章を入力します
   - 「読み上げ」ボタンをクリック、または `Ctrl+Enter` を押します

**重要**: VOICEVOX Engine はアプリケーションと共に自動起動するため、手動での起動は不要です。

### 開発環境での使用

#### リポジトリのクローンと依存関係のインストール

```bash
git clone https://github.com/birdrock926/VOICEVOX-yomiage-GUI
cd yomiage1
npm install
```

#### 開発サーバーの起動

```bash
# Electronアプリケーションとして起動
npm run dev

# Web版として起動（ブラウザで動作）
npm run dev:web
```

#### ビルド（実行可能ファイルの作成）

```bash
# Windows用
npm run build:win
```

ビルドされたファイルは `release/` ディレクトリに出力されます。

## 設定項目

### 音声パラメータ

- **速度 (Speed Scale)**: 0.5 ～ 2.0（デフォルト: 1.0）
- **ピッチ (Pitch Scale)**: -0.15 ～ 0.15（デフォルト: 0.0）
- **抑揚 (Intonation Scale)**: 0.0 ～ 2.0（デフォルト: 1.0）
- **音量 (Volume Scale)**: 0.0 ～ 2.0（デフォルト: 1.0）
- **開始/終了無音時間**: 音声の前後に挿入される無音時間の調整

### キーバインド

デフォルトのキーバインド設定:

- **送信**: `Ctrl+Enter`
- **クリップボードから読み上げ**: `Ctrl+Shift+R`
- **ウィンドウ表示切替**: `Ctrl+Shift+Z`（グローバルホットキー）
- **テキストクリア**: `Ctrl+Shift+X`
- **入力欄フォーカス**: `Ctrl+Shift+F`

全てのキーバインドは設定画面から変更可能です。

### テキスト処理

テキスト自動置換ルールを設定できます（デフォルト例）:

- `www` → `ダブリュー ダブリュー ダブリュー`
- `w` → `ワラ`
- `草` → `クサ`
- `URL` → `ユーアールエル`

### ユーザーインターフェース設定

- 履歴の表示/非表示
- 履歴保持件数（5～100件）
- コンパクトモード
- 読み上げ後の自動最小化
- システムトレイへの最小化

### 詳細設定

- サーバーポート番号
- 再接続試行回数および待機時間
- リクエストタイムアウト時間
- デバッグログの有効化

## 話者の選択

本アプリケーションは、同梱されているVOICEVOX Engineの全ての話者に対応しています。話者選択画面では、検索機能、カテゴリフィルター、お気に入り機能を使用して、目的の話者を素早く選択できます。

### 主要な話者（一部）

**ずんだもん**
- ノーマル（ID: 3）
- あまあま（ID: 1）
- ツンツン（ID: 7）
- セクシー（ID: 5）

**四国めたん**
- ノーマル、あまあま、ツンツン、セクシー

**春日部つむぎ**
- ノーマル

**雨晴はう**
- ノーマル

その他、VOICEVOX Engineに含まれている全ての話者が自動的にドロップダウンリストに表示されます。

## トラブルシューティング

### VOICEVOXに接続できない場合

- アプリケーション起動直後はEngineの起動に数秒かかります。少し待ってから再試行してください
- http://127.0.0.1:50021/docs にブラウザでアクセスできるか確認してください
- ファイアウォールやアンチウイルスソフトがポート50021をブロックしていないか確認してください
- ポート50021が他のアプリケーションに使用されていないか確認してください
- アプリケーションログ（app.log）を確認してEngineの起動エラーがないかチェックしてください

### 音声が再生されない場合

- ブラウザの音声再生が許可されているか確認してください
- システムの音量設定を確認してください
- 仮想オーディオデバイスが正しく設定されているか確認してください

### ゲームのボイスチャットに音声が送られない場合

- システムの**再生デバイス**が仮想オーディオデバイス（VB-CABLE Input等）に設定されているか確認してください
- Discord/ゲームの**マイク入力**が仮想オーディオデバイスの出力（VB-CABLE Output等）に設定されているか確認してください
- 仮想オーディオデバイスのドライバーが正しくインストールされているか確認してください

### グローバルホットキーが動作しない場合

- Electron版（デスクトップアプリ）を使用しているか確認してください
- 他のアプリケーションとのキーバインド競合がないか確認してください
- 管理者権限で実行してみてください

## 技術仕様

### フロントエンド

- **React 18**: ユーザーインターフェースフレームワーク
- **Vite**: ビルドツール
- **TailwindCSS**: スタイリングフレームワーク
- **Socket.IO Client**: リアルタイム通信ライブラリ
- **Web Audio API**: 低遅延音声再生
- **Context API**: 設定管理システム

### バックエンド

- **Node.js**: サーバーランタイム環境
- **Express**: Webアプリケーションフレームワーク
- **Socket.IO**: WebSocketサーバー
- **Axios**: HTTPクライアントライブラリ

### デスクトップアプリケーション

- **Electron**: デスクトップアプリケーションフレームワーク
- **electron-builder**: パッケージングツール
- **グローバルショートカット**: システムワイドなホットキー機能
- **システムトレイ**: トレイアイコン機能

## パフォーマンス最適化

本アプリケーションは以下の最適化により、従来手法よりも大幅な低遅延を実現しています:

1. **ファイルI/O削減**: ファイル監視・読み書きを排除し、メモリ内で処理
2. **WebSocket通信**: Socket.IOによるリアルタイム双方向通信
3. **Web Audio API**: ブラウザネイティブの低遅延音声再生機能の活用
4. **Base64転送**: バイナリデータの効率的な転送
5. **非同期処理**: Promise/async-awaitによる並列処理

典型的な処理時間:
- VOICEVOX 音声合成: 300-800ms
- ネットワーク転送: 10-50ms
- 音声再生開始: 10-30ms
- **合計**: 約350-900ms（従来手法の数秒から大幅改善）

## プロジェクト構成

```
yomiage1/
├── electron/              # Electronメインプロセス
│   ├── main.cjs          # メインプロセス（グローバルホットキー、トレイ等）
│   └── preload.cjs       # プリロードスクリプト（IPC通信）
├── server/               # バックエンドサーバー
│   ├── index.js          # Express + Socket.IOサーバー
│   └── voicevox.js       # VOICEVOX APIラッパー
├── src/                  # フロントエンド
│   ├── components/       # Reactコンポーネント
│   │   ├── AudioPlayer.jsx          # Web Audio API再生
│   │   ├── SettingsModal.jsx        # 設定UI
│   │   ├── SpeakerSelector.jsx      # 話者選択UI
│   │   ├── AudioDeviceManager.jsx   # オーディオデバイス管理
│   │   └── SetupWizard.jsx          # 初回セットアップウィザード
│   ├── contexts/         # React Context
│   │   └── SettingsContext.jsx      # 設定管理
│   ├── App.jsx           # メインUIコンポーネント
│   ├── main.jsx          # エントリーポイント
│   └── index.css         # TailwindCSS + カスタムスタイル
├── build/                # アイコン等のリソース
├── release/              # ビルド出力先
├── index.html
├── package.json
├── vite.config.js
└── README.md
```

## カスタマイズ

### VOICEVOX Engine について

VOICEVOX Engine はアプリケーションに同梱されており、起動時に自動的に実行されます。通常、ユーザーが手動で操作する必要はありません。

**エンジンの場所**:
- Windows: `resources/voicevox-engine/`
- 開発環境: `voicevox-engine/`

**接続URL**: デフォルトで `http://127.0.0.1:50021`（設定画面から変更可能ですが、通常は変更不要です）

### ポート番号の変更

設定画面の「詳細設定」→「サーバー設定」→「サーバーポート」から変更できます。変更後はアプリケーションの再起動が必要です。

### アイコンの変更

`build/` ディレクトリに `icon.ico` ファイルを配置してください。

## ライセンス

本プロジェクトはMITライセンスの下で公開されています。

VOICEVOXの利用規約については公式サイトをご確認ください:
https://voicevox.hiroshiba.jp/term/

## 謝辞

本プロジェクトの開発にあたり、以下のプロジェクトおよび開発者の皆様に感謝いたします:

- **VOICEVOX開発チーム**: 優れた音声合成エンジンの提供
- **キャラクターデザイナー**: 各話者キャラクターのデザイン

## 関連リンク

- VOICEVOX 公式サイト: https://voicevox.hiroshiba.jp/
- VOICEVOX ENGINE API リポジトリ: https://github.com/VOICEVOX/voicevox_engine
- VB-CABLE: https://vb-audio.com/Cable/
- Electron: https://www.electronjs.org/

## 使用上のヒント

### Discord/ゲーム内で効率的に使用する方法

1. **自動最小化の有効化**: 設定で「読み上げ後に自動最小化」を有効にすることで、読み上げ後に自動的にウィンドウが最小化されます

2. **グローバルホットキーの活用**: `Ctrl+Shift+Z` でウィンドウの表示/非表示を素早く切り替えることができます

3. **クリップボード読み上げ機能**: `Ctrl+Shift+R` でクリップボードのテキストを即座に読み上げることができます

4. **テキスト自動置換の活用**: 頻繁に使用する略語や変換ルールを登録することで、入力の効率化が図れます
   - 例: `おk` → `オッケー`、`りょ` → `了解`

5. **音声パラメータの調整**: ゲームや配信の雰囲気に合わせて速度や抑揚を調整してください

### パフォーマンスの最適化

- 初回起動時はVOICEVOX Engineの初期化に時間がかかることがあります
- 不要なバックグラウンドアプリケーションを終了してください
- 高速なSSDにインストールすることを推奨します
- VOICEVOX Engineは自動的に起動・終了するため、手動での操作は不要です
